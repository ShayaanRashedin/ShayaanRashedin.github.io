<section id="network-scanning-recon" class="project-section">
  <style>
    /* --- Local styles for this section only --- */
    #network-scanning-recon { --card-bg: var(--surface, #0b0f17); --muted:#94a3b8; }
    #network-scanning-recon .subtle { color: var(--muted); font-size: .95rem; }
    #network-scanning-recon .grid { display:grid; gap:1rem; }
    #network-scanning-recon .grid.cols-2{ grid-template-columns:repeat(2,minmax(0,1fr));}
    #network-scanning-recon .grid.cols-3{ grid-template-columns:repeat(3,minmax(0,1fr));}
    #network-scanning-recon figure{ margin:0; background:var(--card-bg); border:1px solid rgba(148,163,184,.2); border-radius:12px; overflow:hidden}
    #network-scanning-recon figcaption{ padding:.5rem .75rem; font-size:.9rem; color:var(--muted); border-top:1px solid rgba(148,163,184,.2)}
    #network-scanning-recon img{ display:block; width:100%; height:auto; cursor:zoom-in }
    #network-scanning-recon pre{ background:var(--card-bg); border:1px solid rgba(148,163,184,.2); border-radius:12px; padding:1rem; overflow:auto }
    #network-scanning-recon code,kbd{ font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace }
    #network-scanning-recon .pill{ display:inline-block; padding:.25rem .6rem; border:1px solid rgba(148,163,184,.35); border-radius:999px; font-size:.8rem; margin-right:.35rem}
    #network-scanning-recon table{ width:100%; border-collapse:separate; border-spacing:0; overflow:hidden; border:1px solid rgba(148,163,184,.2); border-radius:12px }
    #network-scanning-recon th, #network-scanning-recon td{ padding:.65rem .8rem; border-bottom:1px solid rgba(148,163,184,.15); vertical-align:top}
    #network-scanning-recon thead th{ text-align:left; background:rgba(148,163,184,.08) }
    #network-scanning-recon tbody tr:last-child td{ border-bottom:none }
    #network-scanning-recon .sev-high{ color:#ef4444; font-weight:700 }
    #network-scanning-recon .sev-med{ color:#f59e0b; font-weight:700 }
    #network-scanning-recon .sev-low{ color:#10b981; font-weight:700 }

    /* Lightbox modal */
    #nsr-modal{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,.75); z-index:9999 }
    #nsr-modal img{ max-width:95vw; max-height:90vh; box-shadow:0 10px 40px rgba(0,0,0,.5); cursor:zoom-out; border-radius:12px }
    #nsr-modal figcaption{ color:#e5e7eb; text-align:center; padding:.5rem 1rem; }
  </style>

  <header>
    <h2>Network Scanning &amp; Reconnaissance — Metasploitable2</h2>
    <p class="subtle">
      Objective: map exposed services, identify software versions/CVEs, and prioritize “easy-win” exploitation paths on an intentionally vulnerable VM.
    </p>
    <div class="pill">Lab: VirtualBox Host-Only (192.168.56.0/24)</div>
    <div class="pill">Attacker: Kali Linux</div>
    <div class="pill">Target: Metasploitable2 (Ubuntu 8.04)</div>
  </header>

  <!-- Topology / Target Identification -->
  <section>
    <h3>1) Target Identification &amp; Connectivity</h3>
    <div class="grid cols-2">
      <figure>
        <img src="ifconfig.png" alt="Metasploitable2 ifconfig showing 192.168.56.101" data-caption="Metasploitable2 (target) is 192.168.56.101 on eth0." />
        <figcaption>Target IP discovered from console: <code>192.168.56.101</code>.</figcaption>
      </figure>
      <figure>
        <img src="ip-addr.png" alt="Kali ip addr output" data-caption="Kali has host-only connectivity via eth1 (10.0.3.15) and NAT via eth0." />
        <figcaption>Attacker network context confirmed on Kali.</figcaption>
      </figure>
    </div>

    <div class="grid cols-2" style="margin-top:1rem">
      <figure>
        <img src="ping.png" alt="ICMP reachability to 192.168.56.101" data-caption="Stable ICMP replies (~0.9–7.5 ms) confirm L3 reachability." />
        <figcaption>ICMP proves host up prior to TCP scans.</figcaption>
      </figure>
      <figure>
        <img src="curl-headers.png" alt="curl -I to port 80 returns Apache 2.2.8 and PHP 5.2.4 headers" data-caption="Banner grab shows Apache/2.2.8 (Ubuntu) with PHP/5.2.4 on port 80." />
        <figcaption>Quick banner grab via <code>curl -I</code> validates web stack.</figcaption>
      </figure>
    </div>

    <details>
      <summary><strong>Commands used</strong> (click to expand)</summary>
      <pre><code># Target console
ifconfig

# Attacker (Kali)
ip addr
ping -c 6 192.168.56.101
curl -I http://192.168.56.101:80</code></pre>
    </details>
  </section>

  <!-- Nmap -->
  <section>
    <h3>2) Enumeration with Nmap</h3>
    <p>
      I performed a full TCP SYN sweep across all 65,535 ports, then a targeted service/version and OS detection sweep to map software and potential CVEs.
    </p>

    <div class="grid cols-2">
      <figure>
        <img src="nmap-full-1.png" alt="Nmap full port scan part 1" data-caption="Full TCP sweep reveals classic Metasploitable2 exposure: FTP(21), SSH(22), Telnet(23), SMTP(25), DNS(53), HTTP(80), RPC, NetBIOS/SMB(139/445), Rlogin(513), RSH(514), NFS, ProFTPD(2121), DistCC(3632), MySQL(3306), PostgreSQL(5432), VNC(5900), UnrealIRCd(6667), AJP(8009), Tomcat HTTP(8180), etc." />
        <figcaption>Full-port results (part 1).</figcaption>
      </figure>
      <figure>
        <img src="nmap-full-2.png" alt="Nmap full port scan part 2" data-caption="Additional high ports present including 6200 (vsftpd backdoor shell) and others." />
        <figcaption>Full-port results (part 2).</figcaption>
      </figure>
    </div>

    <div class="grid cols-2" style="margin-top:1rem">
      <figure>
        <img src="nmap-sv-o-1.png" alt="Nmap -sV -O output part 1" data-caption="Service/version detection fingerprints key software: vsftpd 2.3.4, OpenSSH 4.7p1, Linux telnetd, ISC BIND 9.4.2, Apache httpd 2.2.8 (Ubuntu), Samba 3.x, netkit-rsh/rlogin, ProFTPD 1.3.1, MySQL 5.0.51a, PostgreSQL 8.3.x, VNC, UnrealIRCd, Apache Jserv/AJP 1.3, Tomcat/Coyote JSP 1.1." />
        <figcaption>-sV/-O confirms vulnerable versions.</figcaption>
      </figure>
      <figure>
        <img src="nmap-sv-o-2.png" alt="Nmap -sV -O output part 2" data-caption="OS guess indicates legacy Ubuntu 8.04 under VirtualBox; results warn about non-ideal conditions for exact match." />
        <figcaption>OS fingerprinting &amp; host metadata.</figcaption>
      </figure>
    </div>

    <details>
      <summary><strong>Commands used</strong> (click to expand)</summary>
      <pre><code># Full TCP sweep + output to file
sudo nmap -sS -p- -oN scans/full-port-scan.txt 192.168.56.101

# Version + OS detection on discovered ports
sudo nmap -sV -O -oN scans/version-os-scan.txt 192.168.56.101</code></pre>
    </details>
  </section>

  <!-- Prioritized Findings -->
  <section>
    <h3>3) Prioritized Findings &amp; Attack Paths</h3>
    <p class="subtle">Mapped from Nmap banners, a quick HTTP header grab, and validated against my OpenVAS scan.</p>
    <table>
      <thead>
        <tr>
          <th>Service (Port)</th>
          <th>What’s vulnerable &amp; why it matters</th>
          <th>Exploitability &amp; Fix</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><strong>vsftpd 2.3.4</strong> (21/tcp)</td>
          <td>Known backdoored source build opens a shell on <code>6200/tcp</code> upon a crafted username.</td>
          <td>
            <span class="sev-high">High</span>. Replace with a trusted build; verify signatures; or remove FTP entirely. (OpenVAS flags CVE-2011-2523 and observes port 6200 exposed.) :contentReference[oaicite:2]{index=2}
          </td>
        </tr>
        <tr>
          <td><strong>UnrealIRCd</strong> (6667/tcp)</td>
          <td>Backdoored versions allow remote commands on connect (“AB” trigger string).</td>
          <td><span class="sev-high">High</span>. Remove service or upgrade to a clean build; restrict to internal nets only. :contentReference[oaicite:3]{index=3}</td>
        </tr>
        <tr>
          <td><strong>DistCC</strong> (3632/tcp)</td>
          <td>Trusts clients by default; accepts compilation “jobs” that execute commands server-side.</td>
          <td><span class="sev-high">High</span>. Disable, or restrict with TCP wrappers/firewall; known RCE (CVE-2004-2687). :contentReference[oaicite:4]{index=4}</td>
        </tr>
        <tr>
          <td><strong>Tomcat AJP</strong> (8009/tcp)</td>
          <td>Ghostcat lets attackers read/include arbitrary files in webapps when AJP is exposed.</td>
          <td><span class="sev-high">High</span>. Upgrade Tomcat (≥ 7.0.100/8.5.51/9.0.31) or disable AJP if unused. (CVE-2020-1938). :contentReference[oaicite:5]{index=5}</td>
        </tr>
        <tr>
          <td><strong>Apache 2.2.8 + PHP 5.2.4</strong> (80/tcp)</td>
          <td>Legacy stack; PHP CGI handling bug enables code disclosure/exec via query args.</td>
          <td><span class="sev-high">High</span>. Upgrade Apache/PHP; disable unnecessary modules; confine with AppArmor/SELinux. (CVE-2012-1823 et al.). :contentReference[oaicite:6]{index=6}</td>
        </tr>
        <tr>
          <td><strong>MySQL 5.0.51a</strong> (3306/tcp)</td>
          <td>Default/weak credentials commonly present on MSF2; remote DB access.</td>
          <td><span class="sev-high">High</span>. Enforce strong creds, bind to localhost, and use host firewalls; OpenVAS flags default creds risk. :contentReference[oaicite:7]{index=7}</td>
        </tr>
        <tr>
          <td><strong>PostgreSQL 8.3.x</strong> (5432/tcp)</td>
          <td>Legacy DB with default creds exposure on MSF2.</td>
          <td><span class="sev-high">High</span>. Rotate credentials, restrict network binding, and patch. :contentReference[oaicite:8]{index=8}</td>
        </tr>
        <tr>
          <td><strong>RSH/Rlogin/Rexec</strong> (513/514/512)</td>
          <td>Trust-based, plaintext auth remote shell services.</td>
          <td><span class="sev-high">High</span>. Remove and enforce SSH only. :contentReference[oaicite:9]{index=9}</td>
        </tr>
      </tbody>
    </table>
  </section>

  <!-- OpenVAS -->
  <section>
    <h3>4) Vulnerability Scan Corroboration (OpenVAS)</h3>
    <p>
      I corroborated manual recon with a vulnerability scan. The report (anonymous XML) enumerates <strong>578 findings</strong> across High/Medium/Low on this host and highlights the critical services above (e.g., vsftpd backdoor, Ghostcat, PHP CGI bug, DistCC, weak DB auth). :contentReference[oaicite:10]{index=10}
    </p>
    <p>
      ▶ <a href="openvas-report.xml" target="_blank" rel="noopener">View the full OpenVAS report (XSL-styled)</a> — uses my custom stylesheet for readable, dark-mode tables. :contentReference[oaicite:11]{index=11}
    </p>
  </section>

  <!-- Remediation Plan -->
  <section>
    <h3>5) Risk-Driven Remediation Plan</h3>
    <ol>
      <li><strong>Reduce attack surface:</strong> stop and remove legacy/unused services (r-services, DistCC, UnrealIRCd, Tomcat AJP) and block at host firewall.</li>
      <li><strong>Patch/upgrade:</strong> replace backdoored or EOL packages (vsftpd, Apache/PHP 5.2.x, Tomcat, MySQL/PostgreSQL), move to a supported OS baseline (Ubuntu LTS). :contentReference[oaicite:12]{index=12}</li>
      <li><strong>Harden auth:</strong> enforce strong, unique DB passwords; disable remote DB access or bind to localhost; enforce SSH-only remote admin.</li>
      <li><strong>Segmentation:</strong> isolate lab targets on non-routable host-only networks; restrict inbound rules to specific tester IPs.</li>
      <li><strong>Continuous assessment:</strong> re-run OpenVAS post-patch; track deltas and archive reports for auditability. :contentReference[oaicite:13]{index=13}</li>
    </ol>
  </section>

  <!-- What I Demonstrated -->
  <section>
    <h3>6) What This Demonstrates</h3>
    <ul>
      <li>End-to-end recon workflow (ICMP → full-port TCP → service/version/OS → banner grabbing → vuln scan corroboration).</li>
      <li>Ability to map findings to concrete exploits (vsftpd 2.3.4 backdoor shell, DistCC RCE, Ghostcat AJP file-read, weak DB creds) and propose fixes with rationale. :contentReference[oaicite:14]{index=14}</li>
      <li>Evidence-first documentation: every claim links to reproducible commands and screenshots.</li>
    </ul>
  </section>

  <!-- Evidence Gallery -->
  <section>
    <h3>Evidence Gallery</h3>
    <div class="grid cols-3">
      <figure><img src="ifconfig.png" alt="ifconfig target" data-caption="Target IP address (ifconfig)" /><figcaption>ifconfig (target)</figcaption></figure>
      <figure><img src="ip-addr.png" alt="ip addr kali" data-caption="Kali network context (ip addr)" /><figcaption>ip addr (attacker)</figcaption></figure>
      <figure><img src="ping.png" alt="ping results" data-caption="ICMP reachability" /><figcaption>ping</figcaption></figure>
      <figure><img src="nmap-full-1.png" alt="nmap full 1" data-caption="Nmap full sweep (p1)" /><figcaption>Nmap full (1)</figcaption></figure>
      <figure><img src="nmap-full-2.png" alt="nmap full 2" data-caption="Nmap full sweep (p2)" /><figcaption>Nmap full (2)</figcaption></figure>
      <figure><img src="nmap-sv-o-1.png" alt="nmap sv o 1" data-caption="-sV -O fingerprinting (p1)" /><figcaption>nmap -sV -O (1)</figcaption></figure>
      <figure><img src="nmap-sv-o-2.png" alt="nmap sv o 2" data-caption="-sV -O fingerprinting (p2)" /><figcaption>nmap -sV -O (2)</figcaption></figure>
      <figure><img src="curl-headers.png" alt="curl -I headers" data-caption="HTTP headers show Apache 2.2.8 + PHP 5.2.4" /><figcaption>curl -I</figcaption></figure>
    </div>
  </section>

  <!-- Lightweight modal viewer (no external deps) -->
  <figure id="nsr-modal" aria-hidden="true">
    <img alt="" />
    <figcaption id="nsr-modal-caption"></figcaption>
  </figure>
  <script>
    (function(){
      const modal = document.getElementById('nsr-modal');
      const modalImg = modal.querySelector('img');
      const modalCap = document.getElementById('nsr-modal-caption');

      document.querySelectorAll('#network-scanning-recon img').forEach(img=>{
        img.addEventListener('click', ()=>{
          modal.style.display='flex';
          modalImg.src = img.src;
          modalImg.alt = img.alt||'';
          modalCap.textContent = img.dataset.caption || img.alt || '';
          document.body.style.overflow='hidden';
        });
      });
      modal.addEventListener('click', ()=>{
        modal.style.display='none';
        modalImg.src='';
        document.body.style.overflow='';
      });
      document.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && modal.style.display==='flex'){ modal.click(); }});
    })();
  </script>
</section>